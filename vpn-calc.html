<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ VPN: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ë—é–¥–∂–µ—Ç</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Custom Theme -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563EB',   // Royal Blue
                        secondary: '#06B6D4', // Cyan
                        accent: '#F43F5E',    // Rose
                        dark: '#0F172A',      // Slate 900
                        light: '#F8FAFC',     // Slate 50
                        surface: '#FFFFFF',
                        profit: '#10B981',    // Green
                        cost: '#EF4444'       // Red
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #F1F5F9; color: #1E293B; }
        .chart-container {
            position: relative;
            width: 100%;
            height: 350px;
        }
        .table-responsive { overflow-x: auto; }
        html { scroll-behavior: smooth; }

        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .card-hover:hover {
            transform: translateY(-2px);
            transition: all 0.3s ease;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        /* Custom Select Styling for Dark Mode Card */
        .custom-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            -webkit-print-color-adjust: exact;
            appearance: none;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Navigation -->
    <header class="bg-dark text-white sticky top-0 z-50 shadow-lg">
        <div class="container mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center space-x-2 shrink-0 mr-4">
                <span class="text-2xl">üìä</span>
                <h1 class="text-xl font-bold tracking-wide hidden sm:block">VPN Analytics</h1>
            </div>
            <!-- Navigation pushed to the right, strict row -->
            <nav class="flex items-center gap-3 text-sm font-medium">
                <a href="#russian-cloud" class="bg-rose-600 px-3 py-2 rounded hover:bg-rose-700 transition shadow-md text-white text-center whitespace-nowrap">
                    üá∑üá∫ –†–§
                </a>
                <a href="#europe-latency" class="bg-indigo-600 px-3 py-2 rounded hover:bg-indigo-700 transition shadow-md text-white text-center whitespace-nowrap">
                    üá™üá∫ –ï–≤—Ä–æ–ø–∞
                </a>
                <a href="#economics" class="bg-emerald-600 px-3 py-2 rounded hover:bg-emerald-700 transition shadow-md text-white text-center whitespace-nowrap">
                    üí∞ –ë—é–¥–∂–µ—Ç
                </a>
                <a href="#master-table" class="bg-blue-600 px-3 py-2 rounded hover:bg-blue-700 transition shadow-md text-white text-center whitespace-nowrap">
                    üìã –°–ø–∏—Å–æ–∫
                </a>
            </nav>
        </div>
    </header>

    <!-- Hero -->
    <section class="bg-gradient-to-br from-gray-900 to-blue-900 text-white py-10">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-3xl md:text-4xl font-extrabold mb-2">–ë–∏–∑–Ω–µ—Å-–ø–ª–∞–Ω VPN –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã</h2>
            <p class="text-gray-300 max-w-2xl mx-auto text-sm md:text-base">
                –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä: –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –∏ –æ—Ü–µ–Ω–∏—Ç–µ –±—é–¥–∂–µ—Ç.
            </p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8 space-y-16">

        <!-- SECTION: ECONOMICS -->
        <section id="economics" class="scroll-mt-24">
            <div class="mb-6 flex flex-col md:flex-row md:items-end justify-between">
                <div>
                    <h3 class="text-3xl font-bold text-dark border-l-8 border-emerald-500 pl-4">üí∞ Unit-—ç–∫–æ–Ω–æ–º–∏–∫–∞</h3>
                    <p class="mt-2 text-gray-600 max-w-2xl">
                        –†–∞—Å—á–µ—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø—Ä–∏ ARPU <strong>$3/–º–µ—Å</strong> –∏ —Ç—Ä–∞—Ñ–∏–∫–µ <strong>30 –ì–ë/—é–∑–µ—Ä</strong>.
                    </p>
                </div>
            </div>

            <!-- MIXED STRATEGY CARD (INTERACTIVE) -->
            <div class="bg-gradient-to-r from-slate-800 to-slate-900 rounded-xl shadow-2xl overflow-hidden mb-10 border border-slate-700 text-white">

                <!-- Card Header with Controls -->
                <div class="p-6 border-b border-slate-700">
                    <div class="flex justify-between items-center mb-4">
                        <h4 class="text-xl font-bold flex items-center gap-2">
                            üåç –°–º–µ—à–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è (–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä)
                        </h4>
                        <span class="text-xs font-normal bg-yellow-500 text-black px-2 py-0.5 rounded">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ</span>
                    </div>

                    <p class="text-gray-400 text-sm mb-6">
                        –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞: <strong>40% –†–§</strong>, <strong>40% –ï–≤—Ä–æ–ø–∞</strong>, <strong>20% –ê–º–µ—Ä–∏–∫–∞</strong>.
                        <br>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–∞—Ä–∂–∏.
                    </p>

                    <!-- CONTROLS ROW -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 bg-slate-800/50 p-4 rounded-lg border border-slate-600">
                        <!-- Select RU -->
                        <div>
                            <label class="block text-xs text-rose-400 font-bold uppercase tracking-wider mb-1">üá∑üá∫ –†–§ –ü—Ä–æ–≤–∞–π–¥–µ—Ä</label>
                            <select id="select-ru" onchange="renderMixedTable()" class="custom-select w-full bg-slate-700 border border-slate-600 text-white text-sm rounded-lg focus:ring-rose-500 focus:border-rose-500 block p-2.5">
                                <!-- Populated via JS -->
                            </select>
                        </div>

                        <!-- Select EU -->
                        <div>
                            <label class="block text-xs text-indigo-400 font-bold uppercase tracking-wider mb-1">üá™üá∫ EU –ü—Ä–æ–≤–∞–π–¥–µ—Ä</label>
                            <select id="select-eu" onchange="renderMixedTable()" class="custom-select w-full bg-slate-700 border border-slate-600 text-white text-sm rounded-lg focus:ring-indigo-500 focus:border-indigo-500 block p-2.5">
                                <!-- Populated via JS -->
                            </select>
                        </div>

                        <!-- Select US -->
                        <div>
                            <label class="block text-xs text-blue-400 font-bold uppercase tracking-wider mb-1">üá∫üá∏ US –ü—Ä–æ–≤–∞–π–¥–µ—Ä</label>
                            <select id="select-us" onchange="renderMixedTable()" class="custom-select w-full bg-slate-700 border border-slate-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5">
                                <!-- Populated via JS -->
                            </select>
                        </div>
                    </div>
                </div>

                <!-- TABLE CONTENT -->
                <div class="p-6 overflow-x-auto">
                    <table class="w-full text-center text-sm" id="mixed-table">
                        <thead>
                            <tr class="text-gray-400 border-b border-slate-700">
                                <th class="pb-3 text-left">–Æ–∑–µ—Ä—ã</th>
                                <th class="pb-3">–¢—Ä–∞—Ñ–∏–∫ (–û–±—â–∏–π)</th>
                                <th class="pb-3">–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–°–µ—Ä–≤–µ—Ä–æ–≤)</th>
                                <th class="pb-3">–î–æ—Ö–æ–¥</th>
                                <th class="pb-3">–†–∞—Å—Ö–æ–¥ (–ò–Ω—Ñ—Ä–∞)</th>
                                <th class="pb-3">–ß–∏—Å—Ç–∞—è –ü—Ä–∏–±—ã–ª—å</th>
                            </tr>
                        </thead>
                        <tbody class="text-base transition-all duration-300" id="mixed-tbody">
                            <!-- Injected via JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <h4 class="text-xl font-bold text-gray-800 mb-4">–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º</h4>
            <!-- Single Provider Tables -->
            <div id="economy-tables" class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                <!-- Tables will be injected by JS -->
            </div>
        </section>

        <!-- SECTION: RUSSIAN CLOUD -->
        <section id="russian-cloud" class="grid grid-cols-1 md:grid-cols-3 gap-8 scroll-mt-24">
            <div class="md:col-span-3">
                <h3 class="text-2xl font-bold text-dark border-l-4 border-rose-600 pl-4">üá∑üá∫ –†–æ—Å—Å–∏–π—Å–∫–∏–π –°–µ–≥–º–µ–Ω—Ç</h3>
                <p class="mt-2 text-gray-600">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –º–æ—â–Ω–æ—Å—Ç–µ–π –∏ –∫–∞–Ω–∞–ª–æ–≤.</p>
            </div>

            <div class="bg-surface rounded-xl shadow-md p-6 card-hover md:col-span-2">
                <h4 class="text-lg font-semibold text-gray-800 mb-4">–°—Ç–æ–∏–º–æ—Å—Ç—å (RUB)</h4>
                <div class="chart-container">
                    <canvas id="ruCloudChart"></canvas>
                </div>
            </div>

            <div class="bg-surface rounded-xl shadow-md p-6 card-hover">
                <h4 class="text-lg font-semibold text-gray-800 mb-4">–ò–Ω—Å–∞–π—Ç—ã</h4>
                <ul class="space-y-3 text-sm">
                    <li class="p-2 bg-yellow-50 rounded border-l-2 border-yellow-500">
                        <strong>Yandex Cloud:</strong> –°–∞–º—ã–π —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ì–æ—Å—É—Å–ª—É–≥–∞–º, –Ω–æ –¥–æ—Ä–æ–≥–æ–π —Ç—Ä–∞—Ñ–∏–∫.
                    </li>
                    <li class="p-2 bg-purple-50 rounded border-l-2 border-purple-500">
                         <strong>Aeza:</strong> –¢–æ–ø –≤—ã–±–æ—Ä –ø–æ —Ü–µ–Ω–µ, –∏–≥—Ä–æ–≤–æ–π —Ö–æ—Å—Ç–∏–Ω–≥.
                    </li>
                </ul>
            </div>
        </section>

        <!-- SECTION: EUROPE & TRAFFIC -->
        <section id="europe-latency" class="grid grid-cols-1 lg:grid-cols-2 gap-8 scroll-mt-24">
            <div class="lg:col-span-2">
                <h3 class="text-2xl font-bold text-dark border-l-4 border-indigo-600 pl-4">üá™üá∫ –ï–≤—Ä–æ–ø–∞ –∏ –¢—Ä–∞—Ñ–∏–∫</h3>
            </div>

            <div class="bg-surface rounded-xl shadow-md p-6 card-hover">
                <h4 class="text-lg font-semibold text-gray-800 mb-4">–ü–∏–Ω–≥ –¥–æ –ú–æ—Å–∫–≤—ã (–º—Å)</h4>
                <div class="chart-container">
                    <canvas id="latencyChart"></canvas>
                </div>
            </div>

            <div class="bg-surface rounded-xl shadow-md p-6 card-hover">
                <h4 class="text-lg font-semibold text-gray-800 mb-4">–î–æ—Å—Ç—É–ø–Ω—ã–π –¢—Ä–∞—Ñ–∏–∫</h4>
                <div class="chart-container">
                    <canvas id="trafficChart"></canvas>
                </div>
            </div>
        </section>

        <!-- SECTION: MASTER TABLE -->
        <section id="master-table" class="scroll-mt-24">
            <h3 class="text-2xl font-bold text-dark border-l-4 border-blue-600 pl-4 mb-6">üìã –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤</h3>
            <div class="overflow-x-auto bg-white rounded-xl shadow-lg border border-gray-100">
                <table class="min-w-full text-sm text-left">
                    <thead class="bg-gray-800 text-white uppercase font-bold text-xs">
                        <tr>
                            <th class="px-6 py-4 rounded-tl-xl">–°—Ç—Ä–∞–Ω–∞</th>
                            <th class="px-6 py-4">–•–æ—Å—Ç–∏–Ω–≥</th>
                            <th class="px-6 py-4">–õ–æ–∫–∞—Ü–∏—è</th>
                            <th class="px-6 py-4">–¢—Ä–∞—Ñ–∏–∫</th>
                            <th class="px-6 py-4">–¶–µ–Ω–∞</th>
                            <th class="px-6 py-4 rounded-tr-xl text-center">–õ–∏–Ω–∫</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200 text-gray-700 font-medium" id="master-table-body">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

    </main>

    <footer class="bg-dark text-gray-400 py-10 text-center text-sm">
        <p>&copy; 2025 VPN Infrastructure Report.</p>
    </footer>

    <!-- Logic Script -->
    <script>
        // --- 1. DATA SOURCES ---
        const providers = [
            { id: 'aeza', country: '–†–§/–ï–≤—Ä–æ–ø–∞', name: 'Aeza', region: ['ru', 'eu'], loc: 'Moscow/Stockholm', traffic: 'Unlim (1Gbps)', price: '449 ‚ÇΩ', priceUSD: 5.0, quotaTB: 999, overagePerTB: 0, link: 'aeza.net' },
            { id: 'hetzner', country: '–§–∏–Ω–ª—è–Ω–¥–∏—è', name: 'Hetzner', region: ['eu'], loc: 'Helsinki', traffic: '20 TB', price: '‚Ç¨4.51', priceUSD: 5.0, quotaTB: 20, overagePerTB: 1.1, link: 'hetzner.com' },
            { id: 'hostkey', country: '–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã', name: 'HostKey', region: ['eu'], loc: 'Amsterdam', traffic: 'Unlim', price: '‚Ç¨7.00', priceUSD: 7.7, quotaTB: 999, overagePerTB: 0, link: 'hostkey.com' },
            { id: 'do', country: '–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã', name: 'DigitalOcean', region: ['eu', 'us'], loc: 'Amsterdam/NY', traffic: '1 TB', price: '$6.00', priceUSD: 6.0, quotaTB: 1, overagePerTB: 10, link: 'digitalocean.com' },
            { id: 'yandex', country: '–†–æ—Å—Å–∏—è', name: 'Yandex Cloud', region: ['ru'], loc: 'Moscow', traffic: 'Pay-as-you-go', price: '1200 ‚ÇΩ', priceUSD: 13.0, quotaTB: 0, overagePerTB: 11, link: 'cloud.yandex.ru' },
            { id: 'vk', country: '–†–æ—Å—Å–∏—è', name: 'VK Cloud', region: ['ru'], loc: 'Moscow', traffic: 'Quotas', price: '950 ‚ÇΩ', priceUSD: 10.5, quotaTB: 0, overagePerTB: 10, link: 'mcs.mail.ru' },
            { id: 'sber', country: '–†–æ—Å—Å–∏—è', name: 'SberCloud', region: ['ru'], loc: 'Moscow', traffic: 'Enterprise', price: '1100 ‚ÇΩ', priceUSD: 12.0, quotaTB: 0, overagePerTB: 11, link: 'cloud.ru' },
            { id: 'ovh', country: '–ö–∞–Ω–∞–¥–∞', name: 'OVHcloud', region: ['us'], loc: 'Beauharnois', traffic: 'Unlim', price: '$4.20', priceUSD: 4.2, quotaTB: 999, overagePerTB: 0, link: 'ovhcloud.com' },
            { id: 'vultr', country: '–°–®–ê', name: 'Vultr', region: ['us', 'eu'], loc: 'New Jersey', traffic: '2 TB', price: '$6.00', priceUSD: 6.0, quotaTB: 2, overagePerTB: 10, link: 'vultr.com' },
            { id: 'beget', country: '–≠—Å—Ç–æ–Ω–∏—è', name: 'Beget', region: ['eu'], loc: 'Tallinn', traffic: 'Fair Use', price: '‚Ç¨5.50', priceUSD: 6.0, quotaTB: 10, overagePerTB: 2, link: 'beget.com' }
        ];

        // --- 2. MASTER TABLE GENERATION ---
        const tableBody = document.getElementById('master-table-body');
        providers.forEach(p => {
            const isAeza = p.name === 'Aeza';
            const rowClass = isAeza ? "bg-purple-50 border-l-4 border-purple-500" : "hover:bg-blue-50 transition border-b border-gray-100";

            const row = `
                <tr class="${rowClass}">
                    <td class="px-6 py-4 font-medium">${p.country}</td>
                    <td class="px-6 py-4 font-bold ${isAeza ? 'text-purple-700' : 'text-primary'}">${p.name} ${isAeza ? '<span class="text-xs bg-purple-200 px-1 rounded ml-1">TOP</span>' : ''}</td>
                    <td class="px-6 py-4 text-xs text-gray-500">${p.loc}</td>
                    <td class="px-6 py-4 text-green-700 font-semibold">${p.traffic}</td>
                    <td class="px-6 py-4 font-bold text-dark">${p.price}</td>
                    <td class="px-6 py-4 text-center"><a href="https://${p.link}" target="_blank" class="text-gray-400 hover:text-accent no-underline">üîó</a></td>
                </tr>
            `;
            tableBody.innerHTML += row;
        });

        // --- 3. ECONOMICS CORE ---
        const usersScenarios = [100, 1000, 5000, 10000];
        const avgTrafficPerUserGB = 30;
        const avgRevenuePerUser = 3;

        function calculateProviderCost(provider, trafficTB, activeUsers) {
            let serversForCpu = Math.ceil(activeUsers / 1000);
            if (serversForCpu < 1) serversForCpu = 1;

            let serversBought = serversForCpu;
            let finalCost = 0;

            if (provider.quotaTB === 999) {
                let bandwidthServers = 1;
                if (provider.name.includes('OVH')) {
                     // OVH Starter 100Mbps limitation check ~ 32TB/mo max theoretical
                     bandwidthServers = Math.ceil(trafficTB / 30);
                }
                serversBought = Math.max(serversForCpu, bandwidthServers);
                finalCost = serversBought * provider.priceUSD;

            } else if (provider.quotaTB === 0) {
                // Pay As You Go
                finalCost = (serversBought * provider.priceUSD) + (trafficTB * provider.overagePerTB);
            } else {
                // Quota Logic
                const totalQuota = serversBought * provider.quotaTB;
                const deficit = trafficTB - totalQuota;

                if (deficit > 0) {
                    const costOverage = deficit * provider.overagePerTB;
                    const serversForTraffic = Math.ceil(trafficTB / provider.quotaTB);
                    const costNewServers = serversForTraffic * provider.priceUSD;

                    if (costNewServers < (finalCost + costOverage) && serversForTraffic > serversBought) {
                        serversBought = serversForTraffic;
                        finalCost = serversBought * provider.priceUSD;
                    } else {
                        finalCost = (serversBought * provider.priceUSD) + costOverage;
                    }
                } else {
                    finalCost = serversBought * provider.priceUSD;
                }
            }
            return { cost: finalCost, servers: serversBought };
        }

        // --- 4. INTERACTIVE MIXED STRATEGY ---

        // Populate Selects
        const ruSelect = document.getElementById('select-ru');
        const euSelect = document.getElementById('select-eu');
        const usSelect = document.getElementById('select-us');

        function populateSelect(selectEl, region, defaultId) {
            const options = providers.filter(p => p.region.includes(region));
            options.forEach(p => {
                const opt = document.createElement('option');
                opt.value = p.id;
                opt.innerHTML = `${p.name} ($${p.priceUSD})`;
                if(p.id === defaultId) opt.selected = true;
                selectEl.appendChild(opt);
            });
        }

        // Initial Populations
        populateSelect(ruSelect, 'ru', 'yandex'); // Default expensive RU
        populateSelect(euSelect, 'eu', 'hetzner'); // Default cheap EU
        populateSelect(usSelect, 'us', 'ovh');     // Default cheap US

        function renderMixedTable() {
            const mixedTbody = document.getElementById('mixed-tbody');
            mixedTbody.innerHTML = ''; // Clear current

            const pRU = providers.find(p => p.id === ruSelect.value);
            const pEU = providers.find(p => p.id === euSelect.value);
            const pUS = providers.find(p => p.id === usSelect.value);

            usersScenarios.forEach(users => {
                const totalTraffic = (users * avgTrafficPerUserGB) / 1000;
                const revenue = users * avgRevenuePerUser;

                // Split: 40% RU, 40% EU, 20% US
                const trafficRU = totalTraffic * 0.4;
                const trafficEU = totalTraffic * 0.4;
                const trafficUS = totalTraffic * 0.2;

                const resRU = calculateProviderCost(pRU, trafficRU, users);
                const resEU = calculateProviderCost(pEU, trafficEU, users);
                const resUS = calculateProviderCost(pUS, trafficUS, users);

                const totalCost = resRU.cost + resEU.cost + resUS.cost;

                // Format server string nicely
                const serverStr = `
                    <span class="text-rose-300 font-bold">${resRU.servers}</span> <span class="text-xs text-gray-500">(${pRU.name})</span> +
                    <span class="text-indigo-300 font-bold">${resEU.servers}</span> <span class="text-xs text-gray-500">(${pEU.name})</span> +
                    <span class="text-blue-300 font-bold">${resUS.servers}</span> <span class="text-xs text-gray-500">(${pUS.name})</span>
                `;

                const profit = revenue - totalCost;
                const margin = Math.round((profit / revenue) * 100);

                // Dynamic Margin Color
                let marginColor = "text-emerald-400";
                if(margin < 30) marginColor = "text-yellow-400";
                if(margin < 0) marginColor = "text-red-500";

                const row = `
                    <tr class="border-b border-slate-700 hover:bg-slate-800 transition">
                        <td class="py-4 text-left font-bold pl-4 text-lg">${users}</td>
                        <td class="py-4 text-gray-300">${totalTraffic.toFixed(1)} TB</td>
                        <td class="py-4 text-gray-300 text-sm">${serverStr}</td>
                        <td class="py-4 text-green-400 font-bold">$${revenue.toLocaleString()}</td>
                        <td class="py-4 text-rose-400">$${Math.round(totalCost).toLocaleString()}</td>
                        <td class="py-4 font-bold ${marginColor} text-lg">
                            $${Math.round(profit).toLocaleString()} <span class="text-xs text-gray-400 block font-normal">–ú–∞—Ä–∂–∞: ${margin}%</span>
                        </td>
                    </tr>
                `;
                mixedTbody.innerHTML += row;
            });
        }

        // Initial Render
        renderMixedTable();

        // --- 5. STATIC MONO TABLES ---
        const ecoProviders = [providers[0], providers[1], providers[4], providers[7]]; // Aeza, Hetzner, Yandex, OVH
        const ecoContainer = document.getElementById('economy-tables');

        ecoProviders.forEach(p => {
            let html = `
                <div class="bg-white rounded-xl shadow-lg border-t-4 ${p.priceUSD > 10 ? 'border-red-500' : 'border-green-500'} overflow-hidden">
                    <div class="p-4 bg-gray-50 border-b flex justify-between items-center">
                        <h4 class="font-bold text-lg">${p.name} <span class="text-xs font-normal text-gray-500">(${p.country})</span></h4>
                        <span class="text-xs bg-gray-200 px-2 py-1 rounded">~$${p.priceUSD}/mo</span>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-center">
                            <thead class="bg-gray-100 text-xs text-gray-500">
                                <tr>
                                    <th class="p-2">–Æ–∑–µ—Ä—ã</th>
                                    <th class="p-2">–î–æ—Ö–æ–¥</th>
                                    <th class="p-2">–†–∞—Å—Ö–æ–¥</th>
                                    <th class="p-2">–ü—Ä–∏–±—ã–ª—å</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y">
            `;

            usersScenarios.forEach(users => {
                const totalTraffic = (users * avgTrafficPerUserGB) / 1000;
                const revenue = users * avgRevenuePerUser;
                const res = calculateProviderCost(p, totalTraffic, users);
                const profit = revenue - res.cost;

                html += `
                    <tr>
                        <td class="p-2 font-bold">${users}</td>
                        <td class="p-2 text-green-600 font-bold">$${revenue.toLocaleString()}</td>
                        <td class="p-2 text-red-500 font-semibold">$${Math.round(res.cost).toLocaleString()}</td>
                        <td class="p-2 font-bold ${profit > 0 ? 'text-green-700' : 'text-red-700'}">$${Math.round(profit).toLocaleString()}</td>
                    </tr>
                `;
            });
            html += `</tbody></table></div></div>`;
            ecoContainer.innerHTML += html;
        });

        // --- 6. CHARTS ---
        const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                tooltip: { callbacks: { title: (i) => Array.isArray(i[0].chart.data.labels[i[0].dataIndex]) ? i[0].chart.data.labels[i[0].dataIndex].join(' ') : i[0].chart.data.labels[i[0].dataIndex] } },
                legend: { position: 'bottom', labels: { boxWidth: 12, padding: 15, font: { size: 11 } } }
            }
        };

        new Chart(document.getElementById('ruCloudChart'), {
            type: 'bar',
            data: {
                labels: ['Aeza (Unlim)', 'Yandex Cloud', 'VK Cloud', 'SberCloud'],
                datasets: [{ label: '–¶–µ–Ω–∞ (RUB)', data: [449, 1200, 950, 1100], backgroundColor: ['#A855F7', '#F43F5E', '#2563EB', '#10B981'], borderRadius: 4 }]
            }, options: { ...commonOptions, scales: { y: { beginAtZero: true } } }
        });

        new Chart(document.getElementById('latencyChart'), {
            type: 'bar',
            data: {
                labels: ['Helsinki (FI)', 'Stockholm (Aeza)', 'Tallinn (EE)', 'Amsterdam (NL)', 'New York (US)'],
                datasets: [{ label: 'Ping (ms)', data: [18, 22, 25, 38, 110], backgroundColor: ['#10B981', '#A855F7', '#34D399', '#FBBF24', '#EF4444'], indexAxis: 'y' }]
            }, options: { ...commonOptions, indexAxis: 'y' }
        });

        new Chart(document.getElementById('trafficChart'), {
            type: 'doughnut',
            data: {
                labels: ['Unlimited (Aeza/OVH)', 'High Quota 20TB (Hetzner)', 'Low Quota (US/DO)', 'Paid Traffic (Yandex)'],
                datasets: [{ data: [40, 25, 20, 15], backgroundColor: ['#A855F7', '#3B82F6', '#F59E0B', '#EF4444'], borderWidth: 0 }]
            }, options: { ...commonOptions, layout: { padding: { bottom: 20, top: 10 } }, cutout: '60%' }
        });

    </script>
</body>
</html>